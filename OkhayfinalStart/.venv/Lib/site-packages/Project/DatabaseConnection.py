import pyodbc


class DatabaseConnection:
    @staticmethod
    def get_connection():
        try:
            # Define connection parameters
            server = r'DESKTOP-1O2OM1A\SQLEXPRESS'   # Use raw string to avoid escape issues
            database = 'DB_HMS'  # Replace with your database name

            # Create the connection string
            connection_string = (
                f'DRIVER={{ODBC Driver 17 for SQL Server}};'
                f'SERVER={server};DATABASE={database};Trusted_Connection=yes'
            )

            # Establish and return a fresh connection
            return pyodbc.connect(connection_string)
        except pyodbc.Error as e:
            print("Error connecting to SQL Server:", e)
            raise
